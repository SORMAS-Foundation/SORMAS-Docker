version: '2.3'

services:
  sormas:
    extends:
      file: services-base.yml
      service: base-sormas
    links:
      - postgres
    environment:
#      - DB_JDBC_MAXPOOLSIZE=${DB_JDBC_MAXPOOLSIZE}
      - NAMESIMILARITYTHRESHOLD=${NAMESIMILARITYTHRESHOLD}
    volumes:
      - ${SORMAS_PATH}/documents:/opt/sormas/documents
      - ${SORMAS_PATH}/custom:/opt/sormas/custom
      - ${SORMAS_PATH}/sormas-logs:/opt/domains/sormas/logs
      - ${SORMAS_PATH}/sormas2sormas:/opt/sormas/sormas2sormas
    depends_on:
      - postgres

  apache2:
    extends:
      file: services-base.yml
      service: base-apache2
    links:
      - sormas
#    environment:
#      - PROMETHEUS_SERVERS=${PROMETHEUS_SERVERS}
    volumes:
      - ./apache2/certs:/usr/local/apache2/certs
      - ${SORMAS_PATH}/apache2_log:/var/log/apache2
    ports:
      - 443:443
      - 80:80
    depends_on:
      - sormas

